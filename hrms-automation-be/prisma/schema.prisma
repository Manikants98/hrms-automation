generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("PRISMA_DATABASE_URL")
}

model users {
  id                                                             Int                  @id(map: "PK__users__3213E83F0D3B3A05") @default(autoincrement())
  email                                                          String               @unique(map: "UQ__users__AB6E616419303B34") @db.VarChar(255)
  role_id                                                        Int
  password_hash                                                  String               @db.VarChar(255)
  name                                                           String               @db.VarChar(255)
  parent_id                                                      Int?
  department_id                                                  Int?
  designation_id                                                 Int?
  shift_id                                                       Int?
  salary                                                         Decimal?             @db.Decimal(18, 2)
  currency_code                                                  String?              @db.VarChar(10)
  phone_number                                                   String?              @db.VarChar(20)
  address                                                        String?              @db.VarChar(500)
  employee_id                                                    String?              @unique @db.VarChar(50)
  joining_date                                                   DateTime?            @db.Date
  reporting_to                                                   Int?
  profile_image                                                  String?              @db.VarChar(500)
  last_login                                                     DateTime?            @db.Timestamp
  is_active                                                      String               @default("Y") @map("DF__users__is_active__3B75D760") @db.Char(1)
  createdate                                                     DateTime?            @default(now()) @map("DF__users__createdat__3C69FB99") @db.Timestamp
  createdby                                                      Int
  updatedate                                                     DateTime?            @db.Timestamp
  updatedby                                                      Int?
  log_inst                                                       Int?
  api_tokens_api_tokens_user_idTousers                           api_tokens[]         @relation("api_tokens_user_idTousers")
  approval_workflows_approval_workflows_final_approved_byTousers approval_workflows[] @relation("approval_workflows_final_approved_byTousers")
  approval_workflows_approval_workflows_rejected_byTousers       approval_workflows[] @relation("approval_workflows_rejected_byTousers")
  approval_workflows_approval_workflows_requested_byTousers      approval_workflows[] @relation("approval_workflows_requested_byTousers")
  attendance_user                                                attendance[]         @relation("UserAttendance")
  audit_logs_audit_logs_changed_byTousers                        audit_logs[]         @relation("audit_logs_changed_byTousers")
  login_history_login_history_user_idTousers                     login_history[]      @relation("login_history_user_idTousers")
  notifications                                                  notifications[]
  users                                                          users?               @relation("usersTousers", fields: [reporting_to], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK__users__reporting__403A8C7D")
  other_users                                                    users[]              @relation("usersTousers")
  companies                                                      companies?           @relation(fields: [parent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_role                                                      roles                @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  employees_department                                           departments?         @relation("EmployeesDepartment", fields: [department_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees_designation                                          designations?        @relation("EmployeesDesignation", fields: [designation_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees_shift                                                shifts?              @relation("EmployeesShift", fields: [shift_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  leave_applications_employee                                    leave_applications[] @relation("LeaveApplicationsEmployee")
  leave_applications_approver                                    leave_applications[] @relation("LeaveApplicationsApprover")
  leave_balances_employee                                        leave_balances[]     @relation("LeaveBalancesEmployee")
  salary_structures_employee                                     salary_structures[]  @relation("SalaryStructuresEmployee")
  departments_manager                                            departments[]        @relation("DepartmentsManager")
  job_postings_manager                                           job_postings[]       @relation("JobPostingsManager")
  payroll_processing_processor                                   payroll_processing[] @relation("PayrollProcessingProcessor")
  salary_slips_employee                                          salary_slips[]       @relation("SalarySlipsEmployee")
  workflow_steps_workflow_steps_assigned_user_idTousers          workflow_steps[]     @relation("workflow_steps_assigned_user_idTousers")
  workflow_steps_workflow_steps_processed_byTousers              workflow_steps[]     @relation("workflow_steps_processed_byTousers")
}

model attendance {
  id                    Int                  @id @default(autoincrement())
  user_id               Int
  attendance_date       DateTime             @db.Date
  punch_in_time         DateTime             @db.Timestamp
  punch_in_latitude     Decimal?             @db.Decimal(10, 8)
  punch_in_longitude    Decimal?             @db.Decimal(11, 8)
  punch_in_address      String?              @db.VarChar(500)
  punch_in_device_info  String?              @db.Text
  punch_out_time        DateTime?            @db.Timestamp
  punch_out_latitude    Decimal?             @db.Decimal(10, 8)
  punch_out_longitude   Decimal?             @db.Decimal(11, 8)
  punch_out_address     String?              @db.VarChar(500)
  punch_out_device_info String?              @db.Text
  total_hours           Decimal?             @db.Decimal(5, 2)
  work_type             String?              @default("office") @db.VarChar(20)
  status                String?              @default("Present") @db.VarChar(20)
  remarks               String?              @db.VarChar(500)
  is_active             String               @default("Y") @db.Char(1)
  createdate            DateTime?            @default(now()) @db.Timestamp
  createdby             Int
  updatedate            DateTime?            @db.Timestamp
  updatedby             Int?
  log_inst              Int?
  attendance_user       users                @relation("UserAttendance", fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  attendance_historys   attendance_history[]
}

model attendance_history {
  id                  Int        @id @default(autoincrement())
  attendance_id       Int
  action_type         String     @db.VarChar(50)
  action_time         DateTime   @default(now()) @db.Timestamp
  latitude            Decimal?   @db.Decimal(10, 8)
  longitude           Decimal?   @db.Decimal(11, 8)
  address             String?    @db.VarChar(500)
  device_info         String?    @db.Text
  photo_url           String?    @db.VarChar(500)
  old_data            String?    @db.Text
  new_data            String?    @db.Text
  ip_address          String?    @db.VarChar(50)
  user_agent          String?    @db.VarChar(500)
  app_version         String?    @db.VarChar(50)
  battery_level       Decimal?   @db.Decimal(5, 2)
  network_type        String?    @db.VarChar(20)
  remarks             String?    @db.VarChar(500)
  is_active           String     @default("Y") @db.Char(1)
  createdate          DateTime?  @default(now()) @db.Timestamp
  createdby           Int
  updatedate          DateTime?  @db.Timestamp
  updatedby           Int?
  log_inst            Int?
  attendance_historys attendance @relation(fields: [attendance_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model roles {
  id               Int                @id @default(autoincrement())
  name             String             @unique @db.VarChar(100)
  description      String?            @db.VarChar(500)
  is_active        String             @default("Y") @db.Char(1)
  createdate       DateTime?          @default(now()) @db.Timestamp
  createdby        Int
  updatedate       DateTime?          @db.Timestamp
  updatedby        Int?
  log_inst         Int?
  level            Int                @default(1)
  role_key         String             @unique @db.VarChar(100)
  roles_permission role_permissions[]
  user_role        users[]
}

model permissions {
  id          Int                @id @default(autoincrement())
  name        String             @unique @db.VarChar(100)
  module      String             @db.VarChar(50)
  action      String             @db.VarChar(50)
  description String?            @db.VarChar(500)
  is_active   String             @default("Y") @db.Char(1)
  createdate  DateTime?          @default(now()) @db.Timestamp
  createdby   Int
  updatedate  DateTime?          @db.Timestamp
  updatedby   Int?
  permission  role_permissions[]
}

model role_permissions {
  id               Int         @id @default(autoincrement())
  role_id          Int
  permission_id    Int
  is_active        String      @default("Y") @db.Char(1)
  createdate       DateTime?   @default(now()) @db.Timestamp
  createdby        Int
  updatedate       DateTime?   @db.Timestamp
  updatedby        Int?
  log_inst         Int?
  permission       permissions @relation(fields: [permission_id], references: [id], onUpdate: NoAction)
  roles_permission roles       @relation(fields: [role_id], references: [id], onUpdate: NoAction)
}

model companies {
  id            Int       @id(map: "PK__companie__3213E83FD973FC3D") @default(autoincrement())
  name          String    @db.VarChar(255)
  code          String    @unique(map: "UQ__companie__357D4CF9866FC0C5") @db.VarChar(50)
  address       String?   @db.VarChar(500)
  city          String?   @db.VarChar(100)
  state         String?   @db.VarChar(100)
  country       String?   @db.VarChar(100)
  zipcode       String?   @db.VarChar(20)
  phone_number  String?   @db.VarChar(20)
  email         String?   @db.VarChar(255)
  website       String?   @db.VarChar(255)
  logo          String?   @db.VarChar(500)
  is_active     String    @default("Y") @map("DF__companies__is_ac__25869641") @db.Char(1)
  created_date  DateTime? @default(now()) @map("DF__companies__creat__267ABA7A") @db.Timestamp
  created_by    Int
  updated_date  DateTime? @db.Timestamp
  updated_by    Int?
  log_inst      Int?
  smtp_host     String?   @db.VarChar(50)
  smtp_password String?   @db.VarChar(100)
  smtp_port     Int?
  smtp_username String?   @db.VarChar(200)
  users         users[]
}

model api_tokens {
  id                              Int       @id(map: "PK__api_toke__3213E83FCE2E766B") @default(autoincrement())
  user_id                         Int
  token                           String    @db.Text
  token_type                      String?   @default("Bearer") @map("DF__api_token__token__51851410") @db.VarChar(50)
  issued_at                       DateTime? @default(now()) @map("DF__api_token__issue__52793849") @db.Timestamp
  expires_at                      DateTime? @db.Timestamp
  is_revoked                      Boolean?  @default(false) @map("DF__api_token__is_re__536D5C82")
  device_id                       String?   @db.VarChar(100)
  ip_address                      String?   @db.VarChar(50)
  is_active                       String    @default("Y") @map("DF__api_token__is_ac__546180BB") @db.Char(1)
  log_inst                        Int?
  created_by                      Int
  created_date                    DateTime? @default(now()) @db.Timestamp
  updated_by                      Int?
  updated_date                    DateTime? @db.Timestamp
  users_api_tokens_user_idTousers users     @relation("api_tokens_user_idTousers", fields: [user_id], references: [id], onUpdate: NoAction, map: "FK__api_token__user___5649C92D")
}

model approval_workflows {
  id                                                Int              @id(map: "PK__approval__3213E83F97F542C2") @default(autoincrement())
  workflow_type                                     String           @db.VarChar(30)
  reference_id                                      String           @db.Uuid
  reference_type                                    String           @db.VarChar(50)
  reference_number                                  String           @db.VarChar(100)
  requested_by                                      Int
  request_date                                      DateTime?        @default(now()) @map("DF__approval___reque__10766AC2")
  priority                                          String?          @default("medium") @map("DF__approval___prior__125EB334") @db.VarChar(10)
  status                                            String?          @default("pending") @map("DF__approval___statu__1446FBA6") @db.VarChar(20)
  current_step                                      Int?             @default(1) @map("DF__approval___curre__153B1FDF")
  total_steps                                       Int
  request_data                                      String?          @db.Text
  final_approved_by                                 Int?
  final_approved_at                                 DateTime?
  rejected_by                                       Int?
  rejected_at                                       DateTime?
  rejection_reason                                  String?
  is_active                                         String           @default("Y") @map("DF__approval___is_ac__162F4418") @db.Char(1)
  createdate                                        DateTime?        @default(now()) @map("DF__approval___creat__17236851") @db.Timestamp
  createdby                                         Int
  updatedate                                        DateTime?        @db.Timestamp
  updatedby                                         Int?
  log_inst                                          Int?
  users_approval_workflows_final_approved_byTousers users?           @relation("approval_workflows_final_approved_byTousers", fields: [final_approved_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK__approval___final__190BB0C3")
  users_approval_workflows_rejected_byTousers       users?           @relation("approval_workflows_rejected_byTousers", fields: [rejected_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK__approval___rejec__19FFD4FC")
  users_approval_workflows_requested_byTousers      users            @relation("approval_workflows_requested_byTousers", fields: [requested_by], references: [id], onUpdate: NoAction, map: "FK__approval___reque__18178C8A")
  workflow_steps                                    workflow_steps[]
}

model audit_logs {
  id                                 Int       @id(map: "PK__audit_lo__3213E83F8A4B3909") @default(autoincrement())
  table_name                         String    @db.VarChar(255)
  record_id                          Int
  action                             String    @db.VarChar(10)
  changed_data                       String?   @db.Text
  changed_by                         Int
  changed_at                         DateTime? @default(now()) @map("DF__audit_log__chang__405A880E") @db.Timestamp
  ip_address                         String?   @db.VarChar(50)
  device_info                        String?   @db.VarChar(255)
  session_id                         String?   @db.VarChar(100)
  is_active                          String    @default("Y") @map("DF__audit_log__is_ac__414EAC47") @db.Char(1)
  createdate                         DateTime? @default(now()) @map("DF__audit_log__creat__4242D080") @db.Timestamp
  createdby                          Int
  updatedate                         DateTime? @db.Timestamp
  updatedby                          Int?
  log_inst                           Int?
  users_audit_logs_changed_byTousers users     @relation("audit_logs_changed_byTousers", fields: [changed_by], references: [id], onUpdate: NoAction, map: "FK__audit_log__chang__4336F4B9")
}

model login_history {
  id                                 Int       @id(map: "PK__login_hi__3213E83F66E8EA30") @default(autoincrement())
  user_id                            Int
  login_time                         DateTime? @default(now()) @map("DF__login_his__login__47FBA9D6") @db.Timestamp
  logout_time                        DateTime? @db.Timestamp
  ip_address                         String?   @db.VarChar(50)
  device_info                        String?   @db.VarChar(255)
  os_info                            String?   @db.VarChar(100)
  app_version                        String?   @db.VarChar(50)
  location_latitude                  Decimal?  @db.Decimal(10, 8)
  location_longitude                 Decimal?  @db.Decimal(10, 8)
  login_status                       String?   @default("success") @map("DF__login_his__login__49E3F248") @db.VarChar(20)
  failure_reason                     String?   @db.VarChar(255)
  is_active                          String    @default("Y") @map("DF__login_his__is_ac__4AD81681") @db.Char(1)
  createdate                         DateTime? @default(now()) @map("DF__login_his__creat__4BCC3ABA") @db.Timestamp
  createdby                          Int
  updatedate                         DateTime? @db.Timestamp
  updatedby                          Int?
  log_inst                           Int?
  users_login_history_user_idTousers users     @relation("login_history_user_idTousers", fields: [user_id], references: [id], onUpdate: NoAction, map: "FK__login_his__user___4CC05EF3")
}

model notifications {
  id         Int       @id(map: "PK__notifica__3213E83FD6F9683B") @default(autoincrement())
  user_id    Int
  type       String    @db.VarChar(20)
  category   String    @db.VarChar(20)
  title      String    @db.VarChar(255)
  message    String
  data       String?   @db.Text
  is_read    String    @default("N") @map("DF__notificat__is_re__1D4655FB") @db.Char(1)
  priority   String?   @default("medium") @map("DF__notificat__prior__1F2E9E6D") @db.VarChar(10)
  action_url String?   @db.VarChar(500)
  expires_at DateTime?
  createdate DateTime? @default(now()) @map("DF__notificat__creat__2022C2A6") @db.Timestamp
  read_at    DateTime? @db.Timestamp
  createdby  Int
  updatedate DateTime? @db.Timestamp
  updatedby  Int?
  log_inst   Int?
  users      users     @relation(fields: [user_id], references: [id], onUpdate: NoAction, map: "FK__notificat__user___2116E6DF")
}

model system_settings {
  id          Int       @id @default(autoincrement())
  key_name    String    @unique @db.VarChar(100)
  key_value   String    @db.Text
  value_type  String?   @default("string") @db.VarChar(20)
  description String?   @db.VarChar(255)
  is_active   String    @default("Y") @db.Char(1)
  createdate  DateTime? @default(now()) @db.Timestamp
  createdby   Int
  updatedate  DateTime? @db.Timestamp
  updatedby   Int?
  log_inst    Int?
}

model workflow_steps {
  id                                           Int                @id(map: "PK__workflow__3213E83FB9901905") @default(autoincrement())
  workflow_id                                  Int
  step_number                                  Int
  step_name                                    String             @db.VarChar(255)
  assigned_role                                String             @db.VarChar(50)
  assigned_user_id                             Int?
  status                                       String?            @default("pending") @map("DF__workflow___statu__1DD065E0") @db.VarChar(20)
  comments                                     String?
  processed_by                                 Int?
  processed_at                                 DateTime?
  due_date                                     DateTime?
  is_required                                  Boolean?           @default(true) @map("DF__workflow___is_re__1EC48A19")
  is_active                                    String             @default("Y") @map("DF__workflow___is_ac__1FB8AE52") @db.Char(1)
  createdate                                   DateTime?          @default(now()) @map("DF__workflow___creat__20ACD28B") @db.Timestamp
  createdby                                    Int
  updatedate                                   DateTime?          @db.Timestamp
  updatedby                                    Int?
  log_inst                                     Int?
  users_workflow_steps_assigned_user_idTousers users?             @relation("workflow_steps_assigned_user_idTousers", fields: [assigned_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK__workflow___assig__22951AFD")
  users_workflow_steps_processed_byTousers     users?             @relation("workflow_steps_processed_byTousers", fields: [processed_by], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK__workflow___proce__23893F36")
  approval_workflows                           approval_workflows @relation(fields: [workflow_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "FK__workflow___workf__21A0F6C4")
}

model departments {
  id                      Int            @id @default(autoincrement())
  name                    String         @db.VarChar(255)
  code                    String         @unique @db.VarChar(50)
  description             String?        @db.VarChar(500)
  parent_id               Int?
  manager_id              Int?
  is_active               String         @default("Y") @db.Char(1)
  createdate              DateTime?      @default(now()) @db.Timestamp
  createdby               Int
  updatedate              DateTime?      @db.Timestamp
  updatedby               Int?
  log_inst                Int?
  departments_manager     users?         @relation("DepartmentsManager", fields: [manager_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  departments_parent      departments?   @relation("DepartmentsParent", fields: [parent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  departments_children    departments[]  @relation("DepartmentsParent")
  employees_department    users[]        @relation("EmployeesDepartment")
  job_postings_department job_postings[]
  designations_department designations[]
}

model designations {
  id                       Int            @id @default(autoincrement())
  name                     String         @unique @db.VarChar(255)
  code                     String         @unique @db.VarChar(50)
  description              String?        @db.VarChar(500)
  department_id            Int?
  is_active                String         @default("Y") @db.Char(1)
  createdate               DateTime?      @default(now()) @db.Timestamp
  createdby                Int
  updatedate               DateTime?      @db.Timestamp
  updatedby                Int?
  log_inst                 Int?
  designations_department  departments?   @relation(fields: [department_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees_designation    users[]        @relation("EmployeesDesignation")
  job_postings_designation job_postings[]
}

model shifts {
  id              Int       @id @default(autoincrement())
  name            String    @unique @db.VarChar(255)
  code            String    @unique @db.VarChar(50)
  start_time      String    @db.VarChar(10)
  end_time        String    @db.VarChar(10)
  break_duration  Int?      @default(60)
  description     String?   @db.VarChar(500)
  is_active       String    @default("Y") @db.Char(1)
  createdate      DateTime? @default(now()) @db.Timestamp
  createdby       Int
  updatedate      DateTime? @db.Timestamp
  updatedby       Int?
  log_inst        Int?
  employees_shift users[]   @relation("EmployeesShift")
}

model leave_types {
  id                      Int                  @id @default(autoincrement())
  name                    String               @unique @db.VarChar(100)
  code                    String               @unique @db.VarChar(50)
  max_days_per_year       Int?
  is_paid                 String               @default("Y") @db.Char(1)
  requires_approval       String               @default("Y") @db.Char(1)
  description             String?              @db.VarChar(500)
  is_active               String               @default("Y") @db.Char(1)
  createdate              DateTime?            @default(now()) @db.Timestamp
  createdby               Int
  updatedate              DateTime?            @db.Timestamp
  updatedby               Int?
  log_inst                Int?
  leave_applications_type leave_applications[]
  leave_balances_type     leave_balances[]
}

model leave_applications {
  id                          Int         @id @default(autoincrement())
  employee_id                 Int
  leave_type_id               Int
  start_date                  DateTime    @db.Date
  end_date                    DateTime    @db.Date
  total_days                  Int
  reason                      String      @db.VarChar(500)
  approval_status             String      @default("Pending") @db.VarChar(20)
  approved_by                 Int?
  approved_date               DateTime?   @db.Timestamp
  rejection_reason            String?     @db.VarChar(500)
  is_active                   String      @default("Y") @db.Char(1)
  createdate                  DateTime?   @default(now()) @db.Timestamp
  createdby                   Int
  updatedate                  DateTime?   @db.Timestamp
  updatedby                   Int?
  log_inst                    Int?
  leave_applications_employee users       @relation("LeaveApplicationsEmployee", fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  leave_applications_approver users?      @relation("LeaveApplicationsApprover", fields: [approved_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  leave_applications_type     leave_types @relation(fields: [leave_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model leave_balances {
  id                      Int         @id @default(autoincrement())
  employee_id             Int
  leave_type_id           Int
  total_allocated         Int         @default(0)
  used                    Int         @default(0)
  balance                 Int         @default(0)
  year                    Int
  is_active               String      @default("Y") @db.Char(1)
  createdate              DateTime?   @default(now()) @db.Timestamp
  createdby               Int
  updatedate              DateTime?   @db.Timestamp
  updatedby               Int?
  log_inst                Int?
  leave_balances_employee users       @relation("LeaveBalancesEmployee", fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  leave_balances_type     leave_types @relation(fields: [leave_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([employee_id, leave_type_id, year])
}

model salary_structures {
  id                         Int                      @id @default(autoincrement())
  employee_id                Int
  start_date                 DateTime                 @db.Date
  end_date                   DateTime                 @db.Date
  status                     String                   @default("Active") @db.VarChar(20)
  is_active                  String                   @default("Y") @db.Char(1)
  createdate                 DateTime?                @default(now()) @db.Timestamp
  createdby                  Int
  updatedate                 DateTime?                @db.Timestamp
  updatedby                  Int?
  log_inst                   Int?
  salary_structures_employee users                    @relation("SalaryStructuresEmployee", fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  salary_structure_items     salary_structure_items[]
}

model salary_structure_items {
  id                  Int               @id @default(autoincrement())
  salary_structure_id Int
  structure_type      String            @db.VarChar(100)
  value               Decimal           @db.Decimal(18, 2)
  category            String            @db.VarChar(20)
  is_default          Boolean           @default(false)
  is_active           String            @default("Y") @db.Char(1)
  createdate          DateTime?         @default(now()) @db.Timestamp
  createdby           Int
  updatedate          DateTime?         @db.Timestamp
  updatedby           Int?
  log_inst            Int?
  salary_structure    salary_structures @relation(fields: [salary_structure_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model hiring_stages {
  id                 Int                  @id @default(autoincrement())
  name               String               @unique @db.VarChar(255)
  code               String               @unique @db.VarChar(50)
  description        String?              @db.VarChar(500)
  sequence_order     Int?
  is_active          String               @default("Y") @db.Char(1)
  createdate         DateTime?            @default(now()) @db.Timestamp
  createdby          Int
  updatedate         DateTime?            @db.Timestamp
  updatedby          Int?
  log_inst           Int?
  job_posting_stages job_posting_stages[]
  candidates_stage   candidates[]
}

model attachment_types {
  id                      Int                       @id @default(autoincrement())
  name                    String                    @unique @db.VarChar(255)
  code                    String                    @unique @db.VarChar(50)
  description             String?                   @db.VarChar(500)
  is_active               String                    @default("Y") @db.Char(1)
  createdate              DateTime?                 @default(now()) @db.Timestamp
  createdby               Int
  updatedate              DateTime?                 @db.Timestamp
  updatedby               Int?
  log_inst                Int?
  job_posting_attachments job_posting_attachments[]
}

model job_postings {
  id                       Int                       @id @default(autoincrement())
  job_title                String                    @db.VarChar(255)
  reporting_manager_id     Int?
  department_id            Int?
  designation_id           Int?
  due_date                 DateTime?                 @db.Date
  annual_salary_from       Decimal?                  @db.Decimal(18, 2)
  annual_salary_to         Decimal?                  @db.Decimal(18, 2)
  currency_code            String?                   @db.VarChar(10)
  experience               String?                   @db.VarChar(100)
  posting_date             DateTime?                 @default(now()) @db.Date
  closing_date             DateTime?                 @db.Date
  is_internal_job          String                    @default("N") @db.Char(1)
  description              String?                   @db.Text
  is_active                String                    @default("Y") @db.Char(1)
  createdate               DateTime?                 @default(now()) @db.Timestamp
  createdby                Int
  updatedate               DateTime?                 @db.Timestamp
  updatedby                Int?
  log_inst                 Int?
  job_postings_manager     users?                    @relation("JobPostingsManager", fields: [reporting_manager_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  job_postings_department  departments?              @relation(fields: [department_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  job_postings_designation designations?             @relation(fields: [designation_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  job_posting_stages       job_posting_stages[]
  job_posting_attachments  job_posting_attachments[]
  candidates_job_posting   candidates[]
}

model job_posting_stages {
  id              Int           @id @default(autoincrement())
  job_posting_id  Int
  hiring_stage_id Int
  sequence        Int
  is_active       String        @default("Y") @db.Char(1)
  createdate      DateTime?     @default(now()) @db.Timestamp
  createdby       Int
  updatedate      DateTime?     @db.Timestamp
  updatedby       Int?
  log_inst        Int?
  job_posting     job_postings  @relation(fields: [job_posting_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hiring_stage    hiring_stages @relation(fields: [hiring_stage_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([job_posting_id, hiring_stage_id])
}

model job_posting_attachments {
  id                 Int              @id @default(autoincrement())
  job_posting_id     Int
  attachment_type_id Int
  sequence           Int
  is_active          String           @default("Y") @db.Char(1)
  createdate         DateTime?        @default(now()) @db.Timestamp
  createdby          Int
  updatedate         DateTime?        @db.Timestamp
  updatedby          Int?
  log_inst           Int?
  job_posting        job_postings     @relation(fields: [job_posting_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  attachment_type    attachment_types @relation(fields: [attachment_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([job_posting_id, attachment_type_id])
}

model candidates {
  id                      Int            @id @default(autoincrement())
  name                    String         @db.VarChar(255)
  email                   String         @db.VarChar(255)
  phone_number            String?        @db.VarChar(20)
  job_posting_id          Int
  current_hiring_stage_id Int?
  resume_url              String?        @db.VarChar(500)
  cover_letter_url        String?        @db.VarChar(500)
  application_date        DateTime?      @default(now()) @db.Date
  status                  String         @default("Applied") @db.VarChar(20)
  notes                   String?        @db.Text
  experience_years        Int?
  skills                  String?        @db.VarChar(500)
  expected_salary         Decimal?       @db.Decimal(18, 2)
  current_salary          Decimal?       @db.Decimal(18, 2)
  notice_period           String?        @db.VarChar(100)
  availability_date       DateTime?      @db.Date
  is_active               String         @default("Y") @db.Char(1)
  createdate              DateTime?      @default(now()) @db.Timestamp
  createdby               Int
  updatedate              DateTime?      @db.Timestamp
  updatedby               Int?
  log_inst                Int?
  candidates_job_posting  job_postings   @relation(fields: [job_posting_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  candidates_stage        hiring_stages? @relation(fields: [current_hiring_stage_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model payroll_processing {
  id                           Int            @id @default(autoincrement())
  payroll_month                String         @db.VarChar(2)
  payroll_year                 Int
  processing_date              DateTime       @db.Date
  status                       String         @default("Draft") @db.VarChar(20)
  total_employees              Int            @default(0)
  total_earnings               Decimal        @default(0) @db.Decimal(18, 2)
  total_deductions             Decimal        @default(0) @db.Decimal(18, 2)
  total_leave_deductions       Decimal        @default(0) @db.Decimal(18, 2)
  total_net_salary             Decimal        @default(0) @db.Decimal(18, 2)
  processed_by                 Int?
  is_active                    String         @default("Y") @db.Char(1)
  createdate                   DateTime?      @default(now()) @db.Timestamp
  createdby                    Int
  updatedate                   DateTime?      @db.Timestamp
  updatedby                    Int?
  log_inst                     Int?
  payroll_processing_processor users?         @relation("PayrollProcessingProcessor", fields: [processed_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  salary_slips                 salary_slips[]

  @@unique([payroll_month, payroll_year])
}

model salary_slips {
  id                    Int                @id @default(autoincrement())
  payroll_processing_id Int
  employee_id           Int
  payroll_month         String             @db.VarChar(2)
  payroll_year          Int
  basic_salary          Decimal            @db.Decimal(18, 2)
  total_earnings        Decimal            @db.Decimal(18, 2)
  total_deductions      Decimal            @db.Decimal(18, 2)
  leave_deductions      Decimal            @default(0) @db.Decimal(18, 2)
  net_salary            Decimal            @db.Decimal(18, 2)
  processed_date        DateTime           @db.Date
  paid_date             DateTime?          @db.Date
  status                String             @default("Processed") @db.VarChar(20)
  remarks               String?            @db.VarChar(500)
  is_active             String             @default("Y") @db.Char(1)
  createdate            DateTime?          @default(now()) @db.Timestamp
  createdby             Int
  updatedate            DateTime?          @db.Timestamp
  updatedby             Int?
  log_inst              Int?
  salary_slips_employee users              @relation("SalarySlipsEmployee", fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  salary_slips_payroll  payroll_processing @relation(fields: [payroll_processing_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([employee_id, payroll_month, payroll_year])
}
